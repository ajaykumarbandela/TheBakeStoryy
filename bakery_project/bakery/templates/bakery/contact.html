{% extends 'bakery/base.html' %}

{% block content %}
<body id="abt">
    <section id="aboutus">
      <h1>Contact Us</h1>
      <p>We'd love to hear from you! Whether you have questions about our bakery items, 
      want to place a custom order, or need assistance with your online order, 
      our team at Heavenly Bakery is here to help.</p>
    </section>

    <section id="desc">
      <aside id="de1">
        <h1>Get in Touch</h1>
        <p><i class="fas fa-phone"></i> <strong>Phone:</strong> 8074691873</p>
        <p><i class="fas fa-envelope"></i> <strong>Email:</strong> bandelaajay360@gmail.com</p>
        <p><i class="fas fa-map-marker-alt"></i> <strong>Address:</strong> Chaitanyapuri, Dilsukhnagar, Hyderabad</p>
        <p><i class="fas fa-clock"></i> <strong>Hours:</strong> 10:00 AM - 10:00 PM (Daily)</p>
      </aside>
      <aside id="de2" style="border: 2px solid black; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #fff; max-width: 500px; margin: auto;">
        <h1>Contact Form</h1>
        <div id="contactMessageDiv" style="display: none; padding: 10px; margin: 10px 0; border-radius: 5px; width: 100%;"></div>
        <form id="contactForm">
            <input type="text" id="contactName" name="name" placeholder="Your Name" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px;">
            <input type="email" id="contactEmail" name="email" placeholder="Your Email" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px;">
            <input type="tel" id="contactPhone" name="phone" placeholder="Your Phone Number" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px;">
            <textarea id="contactMessageText" name="message" placeholder="Your Message" rows="5" required style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 5px;"></textarea>
            <button type="submit" id="submitBtn" style="background: #d2691e; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; width: 100%;">Send Message</button>
        </form>
      </aside>
    </section>

    <section id="vistourstore">
      <!-- <aside id="vist1">
        <h2>Visit Our Bakery</h2>
        <p>Chaitanyapuri, Hyderabad</p>
        <p>Open from 10:00 AM to 10:00 PM</p>
        <a href="{% url 'menu' %}"><button>Order Now</button></a>
      </aside> -->
      <aside id="vist2">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ5LDL-d3NGOU40KVEzJxf0UEfXqwQtmrQ64w&s" alt="bakery store">
      </aside>
    </section>

    <footer>
      <h2>Visit Our Bakery</h2>
      <p>Chaitanyapuri, Hyderabad</p>
      <p>Open from 10:00 AM to 10:00 PM</p>
      <a href="{% url 'contact' %}"><button>Contact Us</button></a>
    </footer>
    
    <script>
        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const messageDiv = document.getElementById('contactMessageDiv');
            const form = this;
            
            // Get form data
            const formData = {
                name: document.getElementById('contactName').value.trim(),
                email: document.getElementById('contactEmail').value.trim(),
                phone: document.getElementById('contactPhone').value.trim(),
                message: document.getElementById('contactMessageText').value.trim()
            };
            
            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Sending...';
            
            try {
                const response = await fetch('/api/submit-contact/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const data = await response.json();
                
                if (data.success) {
                    // Show success message
                    messageDiv.style.display = 'block';
                    messageDiv.style.backgroundColor = '#d4edda';
                    messageDiv.style.color = '#155724';
                    messageDiv.style.border = '1px solid #c3e6cb';
                    messageDiv.textContent = data.message;
                    
                    // Reset form
                    form.reset();
                    
                    // Hide message after 5 seconds
                    setTimeout(() => {
                        messageDiv.style.display = 'none';
                    }, 5000);
                } else {
                    // Show error message
                    messageDiv.style.display = 'block';
                    messageDiv.style.backgroundColor = '#f8d7da';
                    messageDiv.style.color = '#721c24';
                    messageDiv.style.border = '1px solid #f5c6cb';
                    messageDiv.textContent = data.error || 'Failed to send message. Please try again.';
                }
            } catch (error) {
                console.error('Error submitting form:', error);
                messageDiv.style.display = 'block';
                messageDiv.style.backgroundColor = '#f8d7da';
                messageDiv.style.color = '#721c24';
                messageDiv.style.border = '1px solid #f5c6cb';
                messageDiv.textContent = 'Network error. Please check your connection and try again.';
            } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.textContent = 'Send Message';
            }
        });
    </script>
</body>
{% endblock %}
